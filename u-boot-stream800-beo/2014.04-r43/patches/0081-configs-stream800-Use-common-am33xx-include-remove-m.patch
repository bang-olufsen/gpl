From 801a2d8f9b0109f5889883c6f8a447bb50f1b08f Mon Sep 17 00:00:00 2001
From: Marek Belisko <marek.belisko@streamunlimited.com>
Date: Fri, 11 Apr 2014 07:40:48 +0200
Subject: [PATCH] configs:stream800: Use common am33xx include + remove
 multiple defined symbols

Signed-off-by: Marek Belisko <marek.belisko@streamunlimited.com>
---
 include/configs/stream800.h | 51 ++++++++++++---------------------------------
 1 file changed, 13 insertions(+), 38 deletions(-)

diff --git a/include/configs/stream800.h b/include/configs/stream800.h
index 690c704..65d7b96 100644
--- a/include/configs/stream800.h
+++ b/include/configs/stream800.h
@@ -19,7 +19,9 @@
 #define __CONFIG_STREAM800_H
 
 #define CONFIG_AM33XX
+#define CONFIG_NAND
 
+#include <configs/ti_am335x_common.h>
 #include <asm/arch/cpu.h>
 #include <asm/arch/hardware.h>
 
@@ -30,16 +32,14 @@
 #define CONFIG_CONST_ENV_COMMON
 #define CONFIG_CONSTANTS_SIZE   (512 << 10) /* 512 KiB */
 
+#if (defined CONFIG_SYS_MALLOC_LEN)
+#undef CONFIG_SYS_MALLOC_LEN
 #define CONFIG_SYS_MALLOC_LEN       (CONFIG_ENV_SIZE + (512 << 10) + \
 		CONFIG_CONSTANTS_SIZE + (1024 << 10) + (10 << 10))
-
-
-/* define CONFIG_SYS_MALLOC_LEN		(1024 << 10) */
-
+#endif
 
 #define CONFIG_SYS_LONGHELP		/* undef to save memory */
 #define CONFIG_SYS_HUSH_PARSER		/* use "hush" command parser */
-#define CONFIG_SYS_PROMPT		"U-Boot# "
 #define CONFIG_BOARD_LATE_INIT
 #define CONFIG_SYS_NO_FLASH
 #define MACH_TYPE_TIAM335EVM		3589	/* Until the next sync */
@@ -72,8 +72,11 @@
 #define CONFIG_LZO
 #define CONFIG_CMD_NAND_TRIMFFS
 #define CONFIG_CMD_MKFS_UBIFS
-#define CONFIG_MTD_UBI_WL_THRESHOLD (4096)
+
+#if (defined CONFIG_MTD_UBI_BEB_RESERVE)
+#undef CONFIG_MTD_UBI_BEB_RESERVE
 #define CONFIG_MTD_UBI_BEB_RESERVE  (2)
+#endif
 
 #define CONFIG_CMD_SFU_PARSER
 #define CONFIG_SFU_RAM
@@ -891,9 +894,6 @@
 
 #define CONFIG_CMD_ECHO
 
-/* max number of command args */
-#define CONFIG_SYS_MAXARGS		16
-
 /* Console I/O Buffer Size */
 #define CONFIG_SYS_CBSIZE		512
 
@@ -912,7 +912,11 @@
 #define CONFIG_SYS_MEMTEST_END		(CONFIG_SYS_MEMTEST_START \
 					+ (8 * 1024 * 1024))
 
+#if (defined CONFIG_SYS_LOAD_ADDR)
+#undef CONFIG_SYS_LOAD_ADDR
 #define CONFIG_SYS_LOAD_ADDR		0x81000000 /* Default load address */
+#endif
+
 #define CONFIG_SYS_HZ			1000 /* 1ms clock */
 
 #define CONFIG_MMC
@@ -931,12 +935,6 @@
 #define CONFIG_CMD_SF
 #define CONFIG_SF_DEFAULT_SPEED		(24000000)
 
- /* Physical Memory Map */
-#define CONFIG_NR_DRAM_BANKS		1		/*  1 bank of DRAM */
-#define PHYS_DRAM_1			0x80000000	/* DRAM Bank #1 */
-#define CONFIG_MAX_RAM_BANK_SIZE	(1024 << 20)	/* 1GB */
-
-#define CONFIG_SYS_SDRAM_BASE		PHYS_DRAM_1
 #define CONFIG_SYS_INIT_SP_ADDR         (NON_SECURE_SRAM_END - \
 						GENERATED_GBL_DATA_SIZE)
  /* Platform/Board specific defs */
@@ -945,11 +943,7 @@
 #define CONFIG_SYS_HZ			1000
 
 /* NS16550 Configuration */
-#define CONFIG_SYS_NS16550
-#define CONFIG_SYS_NS16550_SERIAL
 #define CONFIG_SERIAL_MULTI
-#define CONFIG_SYS_NS16550_REG_SIZE	(-4)
-#define CONFIG_SYS_NS16550_CLK		(48000000)
 #define CONFIG_SYS_NS16550_COM1		0x44e09000	/* Base EVM has UART0 */
 #define CONFIG_SYS_NS16550_COM2		0x48022000	/* UART1 */
 #define CONFIG_SYS_NS16550_COM3		0x48024000	/* UART2 */
@@ -974,10 +968,7 @@
 #define CONFIG_OMAP_GPIO
 
 #define CONFIG_BAUDRATE		115200
-#define CONFIG_SYS_BAUDRATE_TABLE	{ 110, 300, 600, 1200, 2400, \
-4800, 9600, 14400, 19200, 28800, 38400, 56000, 57600, 115200 }
 
-#define CONFIG_ENV_OVERWRITE		1
 #define CONFIG_SYS_CONSOLE_INFO_QUIET
 
 #define CONFIG_ENV_IS_NOWHERE
@@ -985,13 +976,8 @@
 /* Defines for SPL */
 #define CONFIG_SPL
 #define CONFIG_SPL_FRAMEWORK
-#define CONFIG_SPL_TEXT_BASE		0x402F0400
-#define CONFIG_SPL_MAX_SIZE		(101 * 1024)
 #define CONFIG_SPL_STACK		CONFIG_SYS_INIT_SP_ADDR
 
-#define CONFIG_SPL_BSS_START_ADDR	0x80000000
-#define CONFIG_SPL_BSS_MAX_SIZE		0x80000		/* 512 KB */
-
 #define CONFIG_SYS_MMCSD_RAW_MODE_U_BOOT_SECTOR	0x300 /* address 0x60000 */
 #define CONFIG_SYS_U_BOOT_MAX_SIZE_SECTORS	0x200 /* 256 KB */
 #define CONFIG_SYS_MMC_SD_FAT_BOOT_PARTITION	1
@@ -1057,15 +1043,6 @@
  * other needs.
  */
 #define CONFIG_SYS_TEXT_BASE		0x80800000
-#define CONFIG_SYS_SPL_MALLOC_START	0x80208000
-#define CONFIG_SYS_SPL_MALLOC_SIZE	0x100000
-
-/* Since SPL did pll and ddr initialization for us,
- * we don't need to do it twice.
- */
-#ifndef CONFIG_SPL_BUILD
-#define CONFIG_SKIP_LOWLEVEL_INIT
-#endif
 
 /*
  * USB configuration
@@ -1116,13 +1093,11 @@
 #define CONFIG_PHYLIB
 #define CONFIG_PHY_SMSC
 
-#define CONFIG_NAND
 /* NAND support */
 #ifdef CONFIG_NAND
 #define CONFIG_CMD_NAND
 #define CONFIG_NAND_OMAP_GPMC
 #define GPMC_NAND_ECC_LP_x8_LAYOUT	1
-#define CONFIG_SYS_NAND_BASE		(0x08000000)	/* physical address */
 
 #define CONFIG_CMD_CRAMFS
 #define CONFIG_CRAMFS_CMDLINE
-- 
2.7.4

